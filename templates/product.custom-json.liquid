{% layout none %}
{% comment %} Showing product details json {% endcomment %}
{
  "id": {{ product.id }},
  "title": "{{ product.title | escape }}",
  "handle": "{{ product.handle }}",
  "published_at": "{{ product.published_at | date: '%Y-%m-%dT%H:%M:%S%:z' }}",
  "created_at": "{{ product.created_at | date: '%Y-%m-%dT%H:%M:%S%:z' }}",
  "vendor": "{{ product.vendor | escape }}",
  "type": "{{ product.type | escape }}",
  "tags": [ {% for tag in product.tags %}"{{ tag | escape }}"{% unless forloop.last %}, {% endunless %}{% endfor %} ],
  "price": {{ product.price | money_without_currency | remove: ',' | times: 100 | round }},
  "price_min": {{ product.price_min | money_without_currency | remove: ',' | times: 100 | round }},
  "price_max": {{ product.price_max | money_without_currency | remove: ',' | times: 100 | round }},
  "compare_at_price" : {% if product.compare_at_price != blank %}{{ product.compare_at_price }}{% else %}0{% endif %},
  "available": {{ product.available }},
  "featured_image": {%- if product.featured_image %} {
    "id": {{ product.featured_image.id }},
    "position": {{ product.featured_image.position }},
    "src": "{{ product.featured_image.src | image_url: 'master' | remove: "//www.thebluespace.com.au/cdn/shop/" | prepend: 'https://cdn.shopify.com/s/files/1/0014/6938/2771/' }}"
  }{% else %}null{% endif %},
  "featured_media": {%- if product.featured_media %} {
    "id": {{ product.featured_media.id }},
    "src": "{{ product.featured_media.src | image_url: 'master' | prepend: 'https:' }}"
  }{% else %}null{% endif %},
  "price_varies": {{ product.price_varies }},
  "compare_at_price": {{ product.compare_at_price | money_without_currency | remove: ',' | times: 100 | round }},
  "compare_at_price_min": {{ product.compare_at_price_min | money_without_currency | remove: ',' | times: 100 | round }},
  "compare_at_price_max": {{ product.compare_at_price_max | money_without_currency | remove: ',' | times: 100 | round }},
  "compare_at_price_varies": {{ product.compare_at_price_varies }},
  "variants": [
    {%- for variant in product.variants %}
      {
        "id": {{ variant.id }},
        "title": "{{ variant.title | escape }}",
        "option1": "{{ variant.option1 | escape }}",
        "option2": "{{ variant.option2 | escape }}",
        "option3": "{{ variant.option3 | escape }}",
        "sku": "{{ variant.sku | escape }}",
        "requires_shipping": {{ variant.requires_shipping }},
        "taxable": {{ variant.taxable }},
        "featured_image": {%- if variant.featured_image %} {
          "id": {{ variant.featured_image.id }},
          "position": {{ variant.featured_image.position }},
          "src": "{{ variant.featured_image.src | image_url: 'master' | remove: "//www.thebluespace.com.au/cdn/shop/" | prepend: 'https://cdn.shopify.com/s/files/1/0014/6938/2771/' }}"
        }{% else %}null{% endif %},
        "available": {{ variant.available }},
        "name": "{{ product.title | escape }} - {{ variant.title | escape }}",
        "public_title": {% if variant.title != 'Default Title' %}"{{ variant.title | escape }}"{% else %}null{% endif %},
        "options": [ {% for option in variant.options %}"{{ option | escape }}"{% unless forloop.last %}, {% endunless %}{% endfor %} ],
        "price": {{ variant.price | money_without_currency | remove: ',' | times: 100 | round }},
        {% if variant.compare_at_price != blank %}
        "compare_at_price" : {{ variant.compare_at_price }},
        {% else %}
        "compare_at_price" : 0,
        {% endif %}
        "weight": {{ variant.weight | default: 0 }},
        "compare_at_price": {{ variant.compare_at_price | money_without_currency | remove: ',' | times: 100 | round }},
        "barcode": "{{ variant.barcode | escape }}",
        "featured_media": {%- if variant.featured_media %} {
          "id": {{ variant.featured_media.id }},
          "src": "{{ variant.featured_media.src | image_url: 'master' | prepend: 'https:' }}"
        }{% else %}null{% endif %}
      }{% unless forloop.last %},{% endunless -%}
    {% endfor -%}
  ]
}