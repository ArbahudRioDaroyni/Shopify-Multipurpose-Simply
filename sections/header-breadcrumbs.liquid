{% if template contains 'index' %}
  {% comment %} No breadcrumbs on the homepage {% endcomment %}
  {% assign show_breadcrumbs = false %}
{% else %}
  {% assign show_breadcrumbs = true %}
{% endif %}

<div
  id="header-breadcrumbs-{{ section.id }}"
  class="breadcrumbs {{ section.settings.alignment }} color-{{ section.settings.color_scheme }}" 
  style="
    --background-color: var(--color-background);
    --padding-top: {{ section.settings.padding_top }}px;
    --padding-bottom: {{ section.settings.padding_bottom }}px;
    --text-size: {{ section.settings.text_size }}px;
    --text-color: var(--color-text);
    --link-color: var(--color-links);
    --separator-color: var(--color-icons);
  "
  {{ section.shopify_attributes }}
>

  {% if show_breadcrumbs %}
    <div class="breadcrumbs__container container">
      <nav class="breadcrumbs__nav" aria-label="{{ 'general.breadcrumbs.aria_label' | t | default: 'Breadcrumb navigation' }}">
        <ol class="breadcrumbs__list">
          {% comment %} Home link {% endcomment %}
          <li class="breadcrumbs__item">
            <a href="{{ routes.root_url }}" class="breadcrumbs__link">
              {{ 'general.breadcrumbs.home' | t | default: 'Home' }}
            </a>
          </li>

          {% comment %} Handle different page types {% endcomment %}
          {% case template %}
            {% when 'collection' %}
              <li class="breadcrumbs__item">
                <span class="breadcrumbs__separator" aria-hidden="true">{{ section.settings.separator_text }}</span>
                <span class="breadcrumbs__current">{{ collection.title }}</span>
              </li>

            {% when 'product' %}
              {% if collection %}
                <li class="breadcrumbs__item">
                  <span class="breadcrumbs__separator" aria-hidden="true">{{ section.settings.separator_text }}</span>
                  <a href="{{ collection.url }}" class="breadcrumbs__link">{{ collection.title }}</a>
                </li>
              {% endif %}
              <li class="breadcrumbs__item">
                <span class="breadcrumbs__separator" aria-hidden="true">{{ section.settings.separator_text }}</span>
                <span class="breadcrumbs__current">{{ product.title }}</span>
              </li>

            {% when 'blog' %}
              <li class="breadcrumbs__item">
                <span class="breadcrumbs__separator" aria-hidden="true">{{ section.settings.separator_text }}</span>
                <span class="breadcrumbs__current">{{ blog.title }}</span>
              </li>

            {% when 'article' %}
              <li class="breadcrumbs__item">
                <span class="breadcrumbs__separator" aria-hidden="true">{{ section.settings.separator_text }}</span>
                <a href="{{ blog.url }}" class="breadcrumbs__link">{{ blog.title }}</a>
              </li>
              <li class="breadcrumbs__item">
                <span class="breadcrumbs__separator" aria-hidden="true">{{ section.settings.separator_text }}</span>
                <span class="breadcrumbs__current">{{ article.title }}</span>
              </li>

            {% when 'page' %}
              <li class="breadcrumbs__item">
                <span class="breadcrumbs__separator" aria-hidden="true">{{ section.settings.separator_text }}</span>
                <span class="breadcrumbs__current">{{ page.title }}</span>
              </li>

            {% when 'search' %}
              <li class="breadcrumbs__item">
                <span class="breadcrumbs__separator" aria-hidden="true">{{ section.settings.separator_text }}</span>
                <span class="breadcrumbs__current">{{ 'general.search.title' | t | default: 'Search' }}</span>
              </li>

            {% when 'cart' %}
              <li class="breadcrumbs__item">
                <span class="breadcrumbs__separator" aria-hidden="true">{{ section.settings.separator_text }}</span>
                <span class="breadcrumbs__current">{{ 'general.cart.title' | t | default: 'Cart' }}</span>
              </li>

            {% when 'customers/account' %}
              <li class="breadcrumbs__item">
                <span class="breadcrumbs__separator" aria-hidden="true">{{ section.settings.separator_text }}</span>
                <span class="breadcrumbs__current">{{ 'customers.account.title' | t | default: 'Account' }}</span>
              </li>

            {% when 'customers/order' %}
              <li class="breadcrumbs__item">
                <span class="breadcrumbs__separator" aria-hidden="true">{{ section.settings.separator_text }}</span>
                <a href="{{ routes.account_url }}" class="breadcrumbs__link">{{ 'customers.account.title' | t | default: 'Account' }}</a>
              </li>
              <li class="breadcrumbs__item">
                <span class="breadcrumbs__separator" aria-hidden="true">{{ section.settings.separator_text }}</span>
                <span class="breadcrumbs__current">{{ 'customers.order.title' | t | default: 'Order' }} {{ order.name }}</span>
              </li>

            {% when 'list-collections' %}
              <li class="breadcrumbs__item">
                <span class="breadcrumbs__separator" aria-hidden="true">{{ section.settings.separator_text }}</span>
                <span class="breadcrumbs__current">{{ 'collections.general.title' | t | default: 'Collections' }}</span>
              </li>

          {% endcase %}
        </ol>
      </nav>
    </div>
  {% endif %}
</div>

{% stylesheet %}
  .breadcrumbs {
    padding: var(--padding-top) 0 var(--padding-bottom);
    background-color: var(--background-color);
  }

  .breadcrumbs__container {
    margin-block: 0;
  }

  .breadcrumbs__nav {
    width: 100%;
  }

  .breadcrumbs__list {
    display: flex;
    flex-wrap: wrap;
    align-items: center;
    gap: 4px;
    margin: 0;
    padding: 0;
    list-style: none;
    font-size: var(--text-size);
    line-height: 1.4;
  }

  .breadcrumbs__item {
    display: flex;
    align-items: center;
    gap: 4px;
  }

  .breadcrumbs__link {
    color: var(--link-color);
    text-decoration: none;
    transition: opacity 0.3s ease;
  }

  .breadcrumbs__link:hover {
    opacity: 0.7;
    text-decoration: underline;
  }

  .breadcrumbs__separator {
    color: var(--separator-color);
    margin: 0 4px;
  }

  .breadcrumbs__current {
    color: var(--text-color);
    font-weight: 500;
  }

  /* Alignment options */
  .breadcrumbs--left .breadcrumbs__nav {
    text-align: left;
  }

  .breadcrumbs--center .breadcrumbs__nav {
    text-align: center;
  }

  .breadcrumbs--center .breadcrumbs__list {
    justify-content: center;
  }

  .breadcrumbs--right .breadcrumbs__nav {
    text-align: right;
  }

  .breadcrumbs--right .breadcrumbs__list {
    justify-content: flex-end;
  }

  /* Responsive design */
  @media (max-width: 768px) {
    .breadcrumbs__list {
      font-size: calc(var(--text-size) - 1px);
    }

    .breadcrumbs__current,
    .breadcrumbs__link {
      word-break: break-word;
    }
  }

  @media (max-width: 480px) {
    .breadcrumbs__list {
      font-size: calc(var(--text-size) - 2px);
    }
  }
{% endstylesheet %}

{% schema %}
{
  "name": "t:sections.breadcrumbs.name",
  "class": "section-breadcrumbs",
  "settings": [
    {
      "type": "header",
      "content": "t:sections.breadcrumbs.settings.layout.header"
    },
    {
      "type": "select",
      "id": "alignment",
      "label": "t:sections.breadcrumbs.settings.layout.alignment.label",
      "options": [
        {
          "value": "breadcrumbs--left",
          "label": "t:sections.breadcrumbs.settings.layout.alignment.options.left"
        },
        {
          "value": "breadcrumbs--center",
          "label": "t:sections.breadcrumbs.settings.layout.alignment.options.center"
        },
        {
          "value": "breadcrumbs--right",
          "label": "t:sections.breadcrumbs.settings.layout.alignment.options.right"
        }
      ],
      "default": "breadcrumbs--left"
    },
    {
      "type": "text",
      "id": "separator_text",
      "label": "t:sections.breadcrumbs.settings.layout.separator.label",
      "default": "/"
    },
    {
      "type": "header",
      "content": "t:sections.breadcrumbs.settings.typography.header"
    },
    {
      "type": "range",
      "id": "text_size",
      "label": "t:sections.breadcrumbs.settings.typography.text_size.label",
      "min": 10,
      "max": 24,
      "step": 1,
      "unit": "px",
      "default": 14
    },
    {
      "type": "header",
      "content": "t:sections.breadcrumbs.settings.spacing.header"
    },
    {
      "type": "range",
      "id": "padding_top",
      "label": "t:sections.breadcrumbs.settings.spacing.padding_top.label",
      "min": 0,
      "max": 100,
      "step": 4,
      "unit": "px",
      "default": 20
    },
    {
      "type": "range",
      "id": "padding_bottom",
      "label": "t:sections.breadcrumbs.settings.spacing.padding_bottom.label",
      "min": 0,
      "max": 100,
      "step": 4,
      "unit": "px",
      "default": 20
    },
    {
      "type": "color_scheme",
      "id": "color_scheme",
      "label": "t:sections.header_info_bar.settings.color_scheme",
      "default": "scheme-3",
      "info": "t:sections.header_info_bar.settings.color_scheme_info"
    }
  ],
  "presets": [
    {
      "name": "t:sections.breadcrumbs.presets.default.name"
    }
  ]
}
{% endschema %}
